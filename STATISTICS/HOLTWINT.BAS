5 REM HOLT-WINTERS FORECASTING PROGRAM BY C. VAN DER KAAY
10 CLEAR
15 PRINT  " WELCOME TO THE HOLT-WINTERS FORECASTING PROGRAM"
20 PRINT  "------------------------------------------------------------"
25 PRINT  " THIS PROGRAM UTILIZES THE ADVANCED HOLT-WINTERS METHOD FOR"
30 PRINT  " TIME SERIES FORECASTING. IT EFFECTIVELY ESTIMATES LEVEL, TREND,"
35 PRINT  " AND SEASONAL COMPONENTS USING OPTIMIZED SMOOTHING FACTORS:"
40 PRINT  " ALPHA, BETA, AND GAMMA. IDEAL FOR DATA WITH TRENDS AND SEASONALITY,"
45 PRINT  " THIS PROGRAM PROVIDES ACCURATE FUTURE VALUES AND COMPUTES KEY"
50 PRINT  " ERROR METRICS SUCH AS MPE, MAPE, RMSE, MAE, DURBIN-WATSON"
55 PRINT  " STATISTIC, AND THE LJUNG-BOX Q TEST."
60 PRINT  "------------------------------------------------------------"
65 PRINT  " PROGRAM AUTOMATICALLY CALCULATES THE SEASONAL PERIOD BY"
70 PRINT  " ANALYZING THE PERIODICITY IN THE HISTORICAL DATA SERIES USING"
75 PRINT  " THE AUTOCORRELATION FUNCTION (ACF)."
80 PRINT  "------------------------------------------------------------"
140 PRINT 
150 PRINT "PRESS ENTER TO START OR TYPE 'INFO' FOR DETAILS"
160 INPUT BEGIN$
170 IF BEGIN$ = "INFO" THEN GOSUB 7000 : GOTO 150
171 IF BEGIN$ = "" THEN GOTO 190
180 GOTO 150
190 CLEAR
200 DIM Y(200), F(200), S(200), T(200), C(200), U(200), L(200), E(200)
210 INPUT "ENTER NUMBER OF HISTORICAL DATA POINTS: "; N$
211 N = VAL(N$)
212 IF N <= 0 OR N <> INT(N) THEN PRINT "INVALID INPUT. PLEASE ENTER A POSITIVE INTEGER." : GOTO 210
250 FOR I = 1 TO N
260   INPUT "ENTER DATA POINT "; Y$
261   Y(I) = VAL(Y$)
262   IF Y(I) = 0 AND Y$ <> "0" THEN PRINT "INVALID INPUT. PLEASE ENTER A NUMBER." : I = I - 1 : GOTO 270
270   PRINT "YOU ENTERED: "; Y(I)
280   INPUT "IS THIS CORRECT? (Y/N): "; CORRECT$
290   IF CORRECT$ = "N" OR CORRECT$ = "N" THEN I = I - 1
300 NEXT I
310 INPUT "ENTER FORECAST HORIZON: "; H$
311 H = VAL(H$)
312 IF H <= 0 OR H > 100 OR H <> INT(H) THEN PRINT "INVALID INPUT. PLEASE ENTER A NUMBER BETWEEN 1 AND 100." : GOTO 310
315 REM CALCULATE SEASONAL PERIOD AUTOMATICALLY
316 GOSUB 2200 ' CALCULATE ACF AND DETERMINE P
320 PRINT:PRINT "----------------------------------"
321 PRINT "DETECTED SEASONAL PERIOD: "; P
325 PRINT "----------------------------------"
326 PRINT:PRINT "YOU HAVE SUCCESSFULLY ENTERED THE REQUIRED DATA."
327 PRINT "THE PROGRAM WILL NOW BEGIN TESTING VARIOUS SMOOTHING FACTORS"
328 PRINT "TO OPTIMIZE ALPHA, BETA, AND GAMMA."
329 PRINT "THIS ANALYSIS MAY TAKE SOME TIME. PLEASE BE PATIENT."
330 PRINT "PRESS ENTER TO CONTINUE."
335 INPUT CONTINUE$
340 IF CONTINUE$ = "" THEN GOTO 360
345 GOTO 330
350 REM OPTIMIZE SMOOTHING FACTORS
360 BESTMSE = 1E+30
370 FOR ALPHA = 0.1 TO 1 STEP 0.1
380   FOR BETA = 0.1 TO 1 STEP 0.1
390     FOR GAMMA = 0.1 TO 1 STEP 0.1
400       MSE = 0
410       S(1) = Y(1)
420       T(1) = 0
430       FOR I = 1 TO P
440         C(I) = Y(I) - S(1)
450       NEXT I
460       FOR I = P + 1 TO N
470         S(I) = ALPHA * (Y(I) - C(I-P)) + (1 - ALPHA) * (S(I-1) + T(I-1))
480         T(I) = BETA * (S(I) - S(I-1)) + (1 - BETA) * T(I-1)
490         C(I) = GAMMA * (Y(I) - S(I)) + (1 - GAMMA) * C(I-P)
500       NEXT I
510       REM CALCULATE FORECAST AND MSE
520       FOR I = 1 TO H
530         F(N+I) = S(N) + I * T(N) + C(N+I-P)
540       NEXT I
550       FOR I = 1 TO H
560         E(I) = Y(N+I-H) - F(N+I)
570         MSE = MSE + E(I) * E(I)
580       NEXT I
590       MSE = MSE / H
600       PRINT "MSE FOR ALPHA="; ALPHA; " BETA="; BETA; " GAMMA="; GAMMA; ": "; MSE
610       IF MSE < BESTMSE THEN
620         BESTMSE = MSE
630         BESTALPHA = ALPHA
640         BESTBETA = BETA
650         BESTGAMMA = GAMMA
660       END IF
670     NEXT GAMMA
680   NEXT BETA
690 NEXT ALPHA
685 PRINT "------------------------------------------------------------"
700 PRINT "OPTIMAL ALPHA: "; BESTALPHA
710 PRINT "OPTIMAL BETA: "; BESTBETA
720 PRINT "OPTIMAL GAMMA: "; BESTGAMMA
730 PRINT "BEST MEAN SQUARED ERROR: "; BESTMSE
735 PRINT "------------------------------------------------------------"
736 PRINT "OPTIMAL SMOOTHING FACTORS FOUND."
737 PRINT "THE PROGRAM WILL NOW USE THESE FACTORS TO COMPUTE FORECASTS"
738 PRINT "AND CALCULATE ERROR METRICS."
739 PRINT:PRINT "PRESS ENTER TO CONTINUE."
740 INPUT CONTINUE$
750 IF CONTINUE$ = "" THEN GOTO 760
755 GOTO 740
760 REM USE OPTIMAL SMOOTHING FACTORS
770 ALPHA = BESTALPHA
780 BETA = BESTBETA
790 GAMMA = BESTGAMMA
800 S(1) = Y(1)
810 T(1) = 0
820 FOR I = 1 TO P
830   C(I) = Y(I) - S(1)
840 NEXT I
850 FOR I = P + 1 TO N
860   S(I) = ALPHA * (Y(I) - C(I-P)) + (1 - ALPHA) * (S(I-1) + T(I-1))
870   T(I) = BETA * (S(I) - S(I-1)) + (1 - BETA) * T(I-1)
880   C(I) = GAMMA * (Y(I) - S(I)) + (1 - GAMMA) * C(I-P)
890 NEXT I
900 REM FORECAST DATA
910 FOR I = 1 TO H
920   F(N+I) = S(N) + I * T(N) + C(N+I-P)
930 NEXT I
940 REM CALCULATE RESIDUALS AND STANDARD ERROR
950 SUME2 = 0
960 FOR I = 1 TO N
970   E(I) = Y(I) - (S(I) + T(I) * (I - P) + C(I))
980   SUME2 = SUME2 + E(I) * E(I)
990 NEXT I
1000 SE = SQR(SUME2 / N)
1010 REM PRINT FORECASTS WITH PREDICTION INTERVALS
1020 PRINT CHR$(7): PRINT "***********************************"
1030 PRINT "FORECASTS WITH PREDICTION INTERVALS:"
1040 FOR I = 1 TO H
1050   F(N+I) = S(N) + I * T(N) + C(N+I-P)
1060   U(N+I) = F(N+I) + 1.96 * SE
1070   L(N+I) = F(N+I) - 1.96 * SE
1080   PRINT "STEP "; I; " | FORECAST: "; F(N+I); " | UPPER: "; U(N+I); " | LOWER: "; L(N+I)
1090   IF I MOD 20 = 0 THEN GOSUB 2090
1100 NEXT I
1110 PRINT "***********************************"
1120 REM PRINT FORECASTS AND ERRORS
1130 MPE = 0
1140 MAPE = 0
1150 MAE = 0
1160 RMSE = 0
1170 FOR I = 1 TO H
1180   E(I) = (Y(N+I-H) - F(N+I)) / Y(N+I-H)
1190   MPE = MPE + E(I)
1200   MAPE = MAPE + ABS(E(I))
1210   MAE = MAE + ABS(Y(N+I-H) - F(N+I))
1220   RMSE = RMSE + (Y(N+I-H) - F(N+I)) ^ 2
1230   IF I MOD 20 = 0 THEN GOSUB 2090
1240 NEXT I
1250 MPE = MPE / H * 100
1260 MAPE = MAPE / H * 100
1270 MAE = MAE / H
1280 RMSE = SQR(RMSE / H)
1290 PRINT "MEAN PERCENTAGE ERROR: "; MPE; "%"
1300 PRINT "MEAN ABSOLUTE PERCENTAGE ERROR: "; MAPE; "%"
1310 PRINT "MEAN ABSOLUTE ERROR: "; MAE
1320 PRINT "ROOT MEAN SQUARED ERROR: "; RMSE
1330 REM DURBIN-WATSON STATISTIC
1340 DWNUMERATOR = 0
1350 DWDENOMINATOR = 0
1360 FOR I = 2 TO N
1370   DWNUMERATOR = DWNUMERATOR + (Y(I) - Y(I-1)) ^ 2
1380   DWDENOMINATOR = DWDENOMINATOR + Y(I) ^ 2
1390   IF I MOD 20 = 0 THEN GOSUB 2090
1400 NEXT I
1410 DURBINWATSON = DWNUMERATOR / DWDENOMINATOR
1420 PRINT "DURBIN-WATSON STATISTIC: "; DURBINWATSON
1430 REM LJUNG-BOX Q TEST
1440 Q = 0
1450 FOR K = 1 TO 10
1460   SUMRK = 0
1470   FOR T = K + 1 TO N
1480     SUMRK = SUMRK + E(T) * E(T-K)
1490   NEXT T
1500   RK = SUMRK / SUME2
1510   Q = Q + (RK * RK) / (N - K)
1520   IF K MOD 10 = 0 THEN GOSUB 2090
1530 NEXT K
1540 Q = Q * N * (N + 2)
1550 PRINT "LJUNG-BOX Q STATISTIC: "; Q
1560 PRINT "***********************************"
1570 REM CALCULATE AUTOCORRELATION FUNCTION (ACF) FOR THE HISTORICAL DATA SERIES Y
1580 REM AUTOCORRELATION FUNCTION (ACF) CALCULATION
1600 YMEAN = 0
1610 FOR I = 1 TO N
1620   YMEAN = YMEAN + Y(I)
1630 NEXT I
1640 YMEAN = YMEAN / N
1650 FOR LAG = 1 TO 2 * P
1660   NUMERATOR = 0
1670   DENOMINATOR = 0
1680   FOR I = 1 TO N - LAG
1690     NUMERATOR = NUMERATOR + (Y(I) - YMEAN) * (Y(I + LAG) - YMEAN)
1700   NEXT I
1710   FOR I = 1 TO N
1720     DENOMINATOR = DENOMINATOR + (Y(I) - YMEAN) * (Y(I) - YMEAN)
1730   NEXT I
1740   ACF(LAG) = NUMERATOR / DENOMINATOR
1750   PRINT "ACF FOR HISTORICAL DATA AT LAG "; LAG; ": "; ACF(LAG)
1760   IF LAG MOD 20 = 0 THEN GOSUB 2090
1770 NEXT LAG
1780 PRINT "***********************************"
1790 REM CALCULATE AUTOCORRELATION FUNCTION (ACF) FOR RESIDUALS
1800 PRINT "CALCULATING ACF FOR RESIDUALS..."
1810 DIM ACFRES(2 * P)
1820 EMEAN = 0
1830 FOR I = 1 TO N
1840   EMEAN = EMEAN + E(I)
1850 NEXT I
1860 EMEAN = EMEAN / N
1870 FOR LAG = 1 TO 2 * P
1880   NUMERATOR = 0
1890   DENOMINATOR = 0
1900   FOR I = 1 TO N - LAG
1910     NUMERATOR = NUMERATOR + (E(I) - EMEAN) * (E(I + LAG) - EMEAN)
1920   NEXT I
1930   FOR I = 1 TO N
1940     DENOMINATOR = DENOMINATOR + (E(I) - EMEAN) * (E(I) - EMEAN)
1950   NEXT I
1960   ACFRES(LAG) = NUMERATOR / DENOMINATOR
1970   PRINT "ACF FOR RESIDUALS AT LAG "; LAG; ": "; ACFRES(LAG)
1980   IF LAG MOD 20 = 0 THEN GOSUB 2090
1990 NEXT LAG
2010 REM PROMPT USER TO PRINT REPORT OR EXIT
2020 PRINT "WOULD YOU LIKE TO PRINT THE REPORT OR EXIT OR RESTART?"
2030 PRINT "ENTER 'P' TO PRINT, 'E' TO EXIT, 'R' TO RESTART"
2040 INPUT CHOICE$
2050 IF CHOICE$ = "P" OR CHOICE$ = "P" THEN GOSUB 3900 : GOTO 2020
2060 IF CHOICE$ = "E" OR CHOICE$ = "E" THEN GOTO 6100
2070 IF CHOICE$ = "R" OR CHOICE$ = "R" THEN GOTO 190
2080 PRINT "INVALID CHOICE. PLEASE ENTER 'P', 'E', OR 'R'."
2085 GOTO 2020
2090 REM SUBROUTINE FOR PAGINATION
2100 PRINT : PRINT "PRESS ENTER TO CONTINUE..."
2110 INPUT PAUSE$
2120 RETURN
2130 END
2200 REM SUBROUTINE TO CALCULATE ACF AND DETERMINE P
2205 DIM ACF(100)
2207 YMEAN = 0
2210 FOR LAG = 1 TO 100
2220   SUMNUM = 0
2230   SUMDEN = 0
2240   FOR I = LAG + 1 TO N
2250     SUMNUM = SUMNUM + (Y(I) - YMEAN) * (Y(I - LAG) - YMEAN)
2260   NEXT I
2270   FOR I = 1 TO N
2280     SUMDEN = SUMDEN + (Y(I) - YMEAN) ^ 2
2290   NEXT I
2300   ACF(LAG) = SUMNUM / SUMDEN
2310 NEXT LAG
2320 MAXACF = 0
2330 FOR LAG = 2 TO 100
2340   IF ACF(LAG) > MAXACF THEN
2350     MAXACF = ACF(LAG)
2360     P = LAG
2370   END IF
2380 NEXT LAG
2390 RETURN
3900 REM PRINT REPORT SUBROUTINE
3905 CLEAR
3910 PRINT "********** HOLT-WINTERS FORECASTING REPORT **********"
3915 PRINT "SEASONAL PERIOD: "; P
3920 PRINT "OPTIMAL ALPHA: "; BESTALPHA
3930 PRINT "OPTIMAL BETA: "; BESTBETA
3940 PRINT "OPTIMAL GAMMA: "; BESTGAMMA
3950 PRINT "BEST MEAN SQUARED ERROR: "; BESTMSE
3960 PRINT "MEAN PERCENTAGE ERROR: "; MPE; "%"
3970 PRINT "MEAN ABSOLUTE PERCENTAGE ERROR: "; MAPE; "%"
3980 PRINT "MEAN ABSOLUTE ERROR: "; MAE
3990 PRINT "ROOT MEAN SQUARED ERROR: "; RMSE
4000 PRINT "DURBIN-WATSON STATISTIC: "; DURBINWATSON
4010 PRINT "LJUNG-BOX Q STATISTIC: "; Q
4020 PRINT "--------------------------------------"
4030 PRINT "FORECASTS WITH PREDICTION INTERVALS:"
4040 FOR I = 1 TO H
4050   PRINT "STEP "; I; " | FORECAST: "; F(N+I); " | UPPER: "; U(N+I); " | LOWER: "; L(N+I)
4060 NEXT I
4070 PRINT "--------------------------------------"
4080 PRINT "AUTOCORRELATION FUNCTION (ACF) VALUES FOR HISTORICAL DATA:"
4090 FOR LAG = 1 TO 2 * P
4100   PRINT "ACF FOR LAG "; LAG; ": "; ACF(LAG)
4110 NEXT LAG
4120 PRINT "AUTOCORRELATION FUNCTION (ACF) VALUES FOR RESIDUALS:"
4130 FOR LAG = 1 TO 2 * P
4140   PRINT "ACF FOR LAG "; LAG; ": "; ACFRES(LAG)
4150 NEXT LAG
4160 PRINT "********** END OF REPORT **********"
4170 RETURN
6100 REM END CREDITS 
6110 PRINT "******************************************************"
6120 PRINT "*                                                    *"
6130 PRINT "*               HOLT-WINTERS FORECASTING PROGRAM     *"
6140 PRINT "*                                                    *"
6150 PRINT "******************************************************"
6160 PRINT "*                                                    *"
6170 PRINT "*        WRITTEN BY CHRISTOPHER D. VAN DER KAAY      *"
6180 PRINT "*                     PH.D.                          *"
6190 PRINT "*                                                    *"
6200 PRINT "*                         2024                       *"
6210 PRINT "*                                                    *"
6220 PRINT "******************************************************"
6230 PRINT "*                                                    *"
6240 PRINT "*      THANK YOU FOR USING OUR FORECASTING TOOL!     *"
6250 PRINT "*                                                    *"
6260 PRINT "******************************************************"
6290 END
7000 REM INFORMATION MENU SUBROUTINE
7010 CLEAR
7020 PRINT "INFORMATION MENU"
7030 PRINT "--------------------------------------------"
7040 PRINT "1. ABOUT THIS PROGRAM"
7050 PRINT "2. WHEN TO USE HOLT-WINTERS"
7060 PRINT "3. STATISTICS DETAILS"
7070 PRINT "4. RETURN TO MAIN MENU"
7080 PRINT "--------------------------------------------"
7090 INPUT "SELECT AN OPTION (1-4): "; INFO$
7100 IF INFO$ = "1" THEN GOSUB 7105 : GOTO 7020
7110 IF INFO$ = "2" THEN GOSUB 7200 : GOTO 7020
7120 IF INFO$ = "3" THEN GOSUB 7300 : GOTO 7020
7130 IF INFO$ = "4" THEN RETURN
7140 PRINT "INVALID OPTION. PLEASE ENTER 1-4."
7150 GOTO 7020
7105 REM ABOUT THIS PROGRAM
7110 PRINT "ABOUT THIS PROGRAM"
7120 PRINT "--------------------------------------------"
7130 PRINT "THE HOLT-WINTERS METHOD FOR TIME SERIES"
7140 PRINT "FORECASTING IS A COMPREHENSIVE APPROACH"
7150 PRINT "TO ESTIMATING LEVEL, TREND, AND SEASONAL"
7160 PRINT "COMPONENTS. THIS PROGRAM USES OPTIMIZED"
7170 PRINT "SMOOTHING FACTORS: ALPHA (LEVEL), BETA"
7180 PRINT "(TREND), AND GAMMA (SEASONALITY) TO PROVIDE"
7190 PRINT "ACCURATE FORECASTS AND ERROR METRICS."
7200 PRINT "SUITABLE FOR DATA WITH BOTH TREND AND"
7210 PRINT "SEASONAL VARIATIONS, IT HELPS IN MAKING"
7220 PRINT "RELIABLE FUTURE PREDICTIONS."
7230 PRINT "PRESS ENTER TO RETURN."
7240 INPUT PAUSE$
7250 RETURN
7200 REM WHEN TO USE HOLT-WINTERS
7210 PRINT "WHEN TO USE HOLT-WINTERS"
7220 PRINT "--------------------------------------------"
7230 PRINT "HOLT-WINTERS SHOULD BE USED WHEN YOUR DATA"
7240 PRINT "EXHIBITS BOTH TREND AND SEASONALITY. THIS"
7250 PRINT "METHOD IS IDEAL FOR TIME SERIES DATA WHERE"
7260 PRINT "SEASONAL PATTERNS AND TRENDS ARE EXPECTED"
7270 PRINT "TO CONTINUE. EXAMPLES INCLUDE:"
7280 PRINT " 1. MONTHLY SALES FIGURES"
7290 PRINT " 2. QUARTERLY REVENUE DATA"
7300 PRINT " 3. ANNUAL TEMPERATURE READINGS"
7310 PRINT "IT IS LESS SUITABLE FOR DATA WITHOUT CLEAR"
7320 PRINT "SEASONAL OR TREND COMPONENTS."
7330 PRINT "PRESS ENTER TO RETURN."
7340 INPUT PAUSE$
7350 RETURN
7300 REM STATISTICS DETAILS
7310 PRINT "STATISTICS DETAILS"
7320 PRINT "--------------------------------------------"
7330 PRINT "MPE: MEAN PERCENTAGE ERROR"
7340 PRINT " - MEASURES AVERAGE PERCENTAGE ERROR."
7350 PRINT " - INDICATES WHETHER FORECASTS ARE"
7360 PRINT "   CONSISTENTLY TOO HIGH OR LOW."
7370 PRINT " - FORMULA: (1/N) * SUM((ACTUAL-FORECAST)"
7380 PRINT "            / ACTUAL)*100"
7390 PRINT
7400 PRINT "MAPE: MEAN ABSOLUTE PERCENTAGE ERROR"
7410 PRINT " - AVERAGE OF ABSOLUTE PERCENTAGE ERRORS."
7420 PRINT " - USEFUL FOR COMPARING FORECAST ACCURACY"
7430 PRINT "   ACROSS DIFFERENT DATASETS."
7440 PRINT " - FORMULA: (1/N) * SUM(ABS((ACTUAL-"
7450 PRINT "            FORECAST) / ACTUAL))*100"
7460 PRINT "PRESS ENTER FOR MORE DETAILS."
7470 INPUT PAUSE$
7480 GOTO 7490
7490 PRINT "--------------------------------------------"
7500 PRINT "RMSE: ROOT MEAN SQUARED ERROR"
7510 PRINT " - MEASURES THE SQUARE ROOT OF THE AVERAGE"
7520 PRINT "   OF SQUARED ERRORS."
7530 PRINT " - INDICATES THE SPREAD OF FORECAST ERRORS."
7540 PRINT " - FORMULA: SQRT((1/N) * SUM((ACTUAL-"
7550 PRINT "            FORECAST)^2))"
7560 PRINT
7570 PRINT "MAE: MEAN ABSOLUTE ERROR"
7580 PRINT " - AVERAGE OF ABSOLUTE ERRORS."
7590 PRINT " - SHOWS THE AVERAGE MAGNITUDE OF ERRORS"
7600 PRINT "   WITHOUT CONSIDERING THEIR DIRECTION."
7610 PRINT " - FORMULA: (1/N) * SUM(ABS(ACTUAL-"
7620 PRINT "            FORECAST))"
7630 PRINT "PRESS ENTER FOR MORE DETAILS."
7640 INPUT PAUSE$
7650 GOTO 7660
7660 PRINT "--------------------------------------------"
7670 PRINT "DURBIN-WATSON: AUTOCORRELATION TEST"
7680 PRINT " - TESTS FOR AUTOCORRELATION IN RESIDUALS"
7690 PRINT "   FROM A REGRESSION ANALYSIS."
7700 PRINT " - VALUES CLOSE TO 2 SUGGEST NO AUTOCORREL."
7710 PRINT " - FORMULA: SUM((E(T)-E(T-1))^2) /"
7720 PRINT "            SUM(E(T)^2)"
7730 PRINT
7740 PRINT "LJUNG-BOX Q: AUTOCORRELATION TEST"
7750 PRINT " - TESTS FOR PRESENCE OF AUTOCORRELATION"
7760 PRINT "   IN TIME SERIES DATA."
7770 PRINT " - SIGNIFICANT Q INDICATES NON-RANDOMNESS."
7780 PRINT " - FORMULA: Q = N*(N+2) * SUM((RK^2)/(N-K))"
7790 PRINT "PRESS ENTER TO RETURN."
7800 INPUT PAUSE$
7810 RETURN
7990 REM END OF INFORMATION MENU SUBROUTINE
